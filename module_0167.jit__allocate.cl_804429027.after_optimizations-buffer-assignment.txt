BufferAssignment:
allocation 0: size 512, constant:
 value: <0 constant.2 @0> (size=512,offset=0): bf16[]{:T(256)}
allocation 1: size 242696192, output shape is |bf16[14813,32,1,2,128]|, maybe-live-out:
 value: <1 broadcast_in_dim.1 @0> (size=242696192,offset=0): bf16[14813,32,1,2,128]{4,3,2,1,0:T(2,128)(2,1)}
allocation 2: size 0, color 1, preallocated-temp:

Total bytes used: 242696704 (231.45MiB)

Used values:
<0 constant.2 @0>
 positions:
  constant.2
 uses:
  broadcast_in_dim.1, operand 0
 from instruction: %constant.2 = bf16[]{:T(256)} constant(0)
<1 broadcast_in_dim.1 @0>
 positions:
  broadcast_in_dim.1
 uses:
 from instruction: %broadcast_in_dim.1 = bf16[14813,32,1,2,128]{4,3,2,1,0:T(2,128)(2,1)} broadcast(%constant.2), dimensions={}, metadata={op_name="jit(_allocate)/broadcast_in_dim" source_file="/home/eporat/benchmarking_qwen_omni_tpu/.venv/lib/python3.11/site-packages/tpu_inference/runner/kv_cache.py" source_line=72 source_end_line=72 source_column=15 source_end_column=15}, backend_config={"flag_configs":[],"scoped_memory_configs":[],"used_scoped_memory_configs":[],"output_chunk_bound_config":{"output_chunk_bound":[]}}


HloLiveRange (max 2):
  InstructionSequence:
    0:constant.2
    1:broadcast_in_dim.1
  BufferLiveRange:
    constant.2{}:0-1
    broadcast_in_dim.1{}:1-2
  Live ranges at 1 (peak):
    broadcast_in_dim.1{}: 242696192 bytes (cumulative: 242696192 bytes)
    constant.2{}: 2 bytes (cumulative: 242696194 bytes)
  Stack trace breakdown for peak usage: 242 696 194 bytes
    main.5_spmd (100.0%, total: 242 696 194 bytes, current: 0 bytes, remaining: 242 696 194 bytes)
      ├── jit(_allocate)/broadcast_in_dim (100.0%, total: 242 696 192 bytes, current: 242 696 192 bytes, remaining: 2 bytes)
      └── constant.2 (0.0%, total: 2 bytes, current: 2 bytes, remaining: 0 bytes)
