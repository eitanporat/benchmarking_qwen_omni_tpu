BufferAssignment:
allocation 0: size 512, parameter 1, shape |s32[]| at ShapeIndex {}:
 value: <2 y.2 @0> (size=512,offset=0): s32[]{:T(128)}
allocation 1: size 512, output shape is |u32[]|, maybe-live-out:
 value: <5 add.4 @0> (size=512,offset=0): u32[]{:T(128)}
allocation 2: size 512, parameter 0, shape |u32[]| at ShapeIndex {}:
 value: <0 x.1 @0> (size=512,offset=0): u32[]{:T(128)}
allocation 3: size 0, color 1, preallocated-temp:
allocation 4: size 1024, color 6, preallocated-temp:
 value: <1 copy @6> (size=512,offset=512): u32[]{:T(128)S(6)}
 value: <3 copy.1 @6> (size=512,offset=512): s32[]{:T(128)S(6)}
 value: <4 convert_element_type.3 @6> (size=512,offset=0): u32[]{:T(128)S(6)}

Total bytes used: 2560 (2.5KiB)

Used values:
<0 x.1 @0>
 positions:
  x.1
 uses:
  copy, operand 0
 from instruction: %x.1 = u32[]{:T(128)} parameter(0), metadata={op_name="x"}
<1 copy @6>
 positions:
  copy
 uses:
  add.4, operand 0
 from instruction: %copy = u32[]{:T(128)S(6)} copy(%x.1)
<2 y.2 @0>
 positions:
  y.2
 uses:
  copy.1, operand 0
 from instruction: %y.2 = s32[]{:T(128)} parameter(1), metadata={op_name="y"}
<3 copy.1 @6>
 positions:
  copy.1
 uses:
  convert_element_type.3, operand 0
 from instruction: %copy.1 = s32[]{:T(128)S(6)} copy(%y.2)
<4 convert_element_type.3 @6>
 positions:
  convert_element_type.3
 uses:
  add.4, operand 1
 from instruction: %convert_element_type.3 = u32[]{:T(128)S(6)} convert(%copy.1), metadata={op_name="jit(add)/convert_element_type" source_file="/home/eporat/benchmarking_qwen_omni_tpu/.venv/lib/python3.11/site-packages/flax/nnx/rnglib.py" source_line=77 source_end_line=77 source_column=4 source_end_column=24}
<5 add.4 @0>
 positions:
  add.4
 uses:
 from instruction: %add.4 = u32[]{:T(128)} add(%copy, %convert_element_type.3), metadata={op_name="jit(add)/add" source_file="/home/eporat/benchmarking_qwen_omni_tpu/.venv/lib/python3.11/site-packages/flax/nnx/rnglib.py" source_line=77 source_end_line=77 source_column=4 source_end_column=24}


HloLiveRange (max 6):
  InstructionSequence:
    0:y.2
    1:x.1
    2:copy.1
    3:convert_element_type.3
    4:copy
    5:add.4
  BufferLiveRange:
    x.1{}:0-6
    copy{}:4-5
    y.2{}:0-6
    copy.1{}:2-3
    convert_element_type.3{}:3-5
    add.4{}:5-6
  Live ranges at 4 (peak):
    convert_element_type.3{}: 4 bytes (cumulative: 4 bytes)
    copy{}: 4 bytes (cumulative: 8 bytes)
    x.1{}: 4 bytes (cumulative: 12 bytes)
    y.2{}: 4 bytes (cumulative: 16 bytes)
  Stack trace breakdown for peak usage: 16 bytes
    main.5 (100.0%, total: 16 bytes, current: 0 bytes, remaining: 16 bytes)
      ├── copy (25.0%, total: 4 bytes, current: 4 bytes, remaining: 12 bytes)
      ├── jit(add)/convert_element_type (25.0%, total: 4 bytes, current: 4 bytes, remaining: 8 bytes)
      ├── x (25.0%, total: 4 bytes, current: 4 bytes, remaining: 4 bytes)
      └── y (25.0%, total: 4 bytes, current: 4 bytes, remaining: 0 bytes)
